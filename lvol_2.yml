---
- name: Create LVM
  hosts: all
  tasks:
    - block:
        - name: Create a logical volume of 2000m
          community.general.lvol:
            vg: researchzz
            lv: datazz
            size: 3000m
        - name: Create ext4
          community.general.filesystem:
            fstype: ext4
            dev: /dev/researchzz/datazz
      rescue:
        - name: Could not create lvm
          ansible.builtin.debug:
            msg: Could not create logical volume of that size
        - name: Create a logical volume of 30M
          community.general.lvol:
            vg: researchzz
            lv: datazz
            size: 10m
        - name: Create ext4
          community.general.filesystem:
            fstype: ext4
            dev: /dev/researchzz/datazz
      when: ansible_lvm.vgs.researchzz is defined
    - debug:
        msg: Volume group does not exist
      when: ansible_lvm.vgs.researchzz is not defined

